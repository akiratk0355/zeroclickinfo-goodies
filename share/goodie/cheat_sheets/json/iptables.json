{
    "id": "iptables_cheat_sheet",
    "name": "Iptables",
    "description": "Administration tool for IPv4/IPv6 packet filtering and NAT",

    "metadata": {
        "sourceName": "Netfilter",
        "sourceUrl" : "http://ipset.netfilter.org/iptables.man.html"
    },

    "aliases": [
        "ip6tables", "iptable", "linux firewall"
    ],

    "template_type": "terminal",

    "section_order": [
        "Basic Commands",
	"Tables",
	"Targets",
	"Basic Parameters",
	"Matches",
	"Examples"
    ],

    "sections": {
        "Basic Commands": [
            {
                "key": "sudo iptables -L \\[chain\\] -v -n",
                "val": "List all rules in the selected chain with verbose and numeric output"
            },
	    {
		"key": "sudo iptables -S \\[chain\\]",
		"val": "Print all rules in the selected chain"
	    },
	    {
		"key": "sudo iptables -A chain rule-specification",
		"val": "Append one or more rules to the end of the selected chain"
	    },
	    {
		"key": "sudo iptables -I chain \\[rulenum\\] rule-specification",
		"val": "Insert one or more rules in the selected chain as the given rule number"
	    },
	    {
		"key": "sudo iptables -D chain rulenum",
		"val": "Delete one or more rules at the given position from the selected chain"
	    },
	    {
		"key": "sudo iptables -P chain target",
		"val": "Set the policy for the chain to the given target"
	    },
	    {
		"key": "sudo iptables-persistent save",
		"val": "Save current rules for Debian/Ubuntu"
	    },
	    {
		"key": "sudo netfilter-persistent save",
		"val": "Save current rules for Debian 8/Ubuntu 16.04"
	    }
        ],
	"Targets": [
	    {
		"key": "-j targetname \\[per-target-options\\]",
		"val": "Target specification"
	    }
	],
	"Tables" : [
	    {
		"key": "-t tablename",
		"val": "Table specification"
	    }
	],
	"Basic Parameters" : [
	    {
		"key": "-p protocol",
		"val": "Protocol specification"
	    }
	],
	"Matches" : [
	    {
		"key": "-m iprange  --src-range x.x.x.x-x.x.x.x",
		"val": "Match source IP in the specified range"
	    }
	],
	"Examples" : [
	    {
		"key": "sudo iptables -A INPUT -p tcp -m iprange --src-range x.x.x.x-x.x.x.x --dport 22 -j ACCEPT",
		"val": "Allow incoming traffic on SSH from IP in the specified range"
	    }
	]
    }
}
